{% sw_extends '@Storefront/storefront/element/cms-element-moorl-foundation-listing.html.twig' %}

{# Set link to overview page with pre selected filter #}
{% if config('MoorlMerchantFinder.config.category') %}
    {% if page.creator %}
        {% set listingHeaderLink = seoUrl('frontend.navigation.page', { navigationId: config('MoorlMerchantFinder.config.category') }) ~ "?moorl-magazine-article-author=" ~ page.creator.id %}
    {% endif %}

    {% if page.product %}
        {% set listingHeaderLink = seoUrl('frontend.navigation.page', { navigationId: config('MoorlMerchantFinder.config.category') }) ~ "?product=" ~ page.product.id %}
    {% endif %}
{% endif %}

{# Just define item layouts here #}
{# Case 1: From widget or search page #}
{# Case 2: From CMS (auto) #}
{# Case 3: From CMS (others) #}
{% block moorl_foundation_listing_item %}
    {% if element.fieldConfig.elements.itemLayout.value == 'standard' %}
        <li class="{{ listingColumns }}"
            itemscope
            itemtype="https://schema.org/Place">
            {% sw_include '@Storefront/plugin/moorl-merchant-finder/component/merchant-listing/box.html.twig' %}
        </li>
    {% else %}
        {% sw_include '@Storefront/plugin/moorl-foundation/listing-item.html.twig' with {
            url: seoUrl('moorl.merchant.detail', {merchantId: item.id}),
            media: item.media,
            title: item.translated.name,
            meta: item.city,
            schemaOrgType: 'Place',
            description: item.translated.teaser
        } %}
    {% endif %}
{% endblock %}
